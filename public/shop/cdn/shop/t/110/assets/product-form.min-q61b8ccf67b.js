customElements.get("product-form")||customElements.define("product-form",class extends HTMLElement{constructor(){super();this.form=this.querySelector("form");this.form.querySelector("[name=id]").disabled=!1;this.form.addEventListener("submit",this.onSubmitHandler.bind(this));this.cart=document.querySelector("cart-notification")||document.querySelector("cart-drawer");this.submitButton=this.querySelector('[type="submit"]');document.querySelector("cart-drawer")&&this.submitButton.setAttribute("aria-haspopup",
"dialog");this.hideErrors="true"===this.dataset.hideErrors}onSubmitHandler(b){b.preventDefault();if("true"!==this.submitButton.getAttribute("aria-disabled")){this.handleErrorMessage();this.submitButton.setAttribute("aria-disabled",!0);if (this.submitButton.getAttribute('no-animation') != 'true') {this.submitButton.classList.add("loading");this.querySelector(".loading-overlay__spinner").classList.remove("hidden");}b=fetchConfig("javascript");b.headers["X-Requested-With"]="XMLHttpRequest";delete b.headers["Content-Type"];var c=new FormData(this.form);this.cart&&
(c.append("sections",this.cart.getSectionsToRender().map(a=>a.id)),c.append("sections_url",window.location.pathname),this.cart.setActiveElement(document.activeElement));b.body=c;fetch(`${routes.cart_add_url}`,b).then(a=>a.json()).then(a=>{if(a.status){publish(PUB_SUB_EVENTS.cartError,{source:"product-form",productVariantId:c.get("id"),errors:a.errors||a.description,message:a.message});this.handleErrorMessage(a.description);var d=this.submitButton.querySelector(".sold-out-message");d&&(this.submitButton.setAttribute("aria-disabled",
!0),this.submitButton.querySelector("span").classList.add("hidden"),d.classList.remove("hidden"),this.error=!0)}else this.cart?(this.error||publish(PUB_SUB_EVENTS.cartUpdate,{source:"product-form",productVariantId:c.get("id")}),this.error=!1,(d=this.closest("quick-add-modal"))?(document.body.addEventListener("modalClosed",()=>{setTimeout(()=>{this.cart.renderContents(a)})},{once:!0}),d.hide(!0)):this.cart.renderContents(a)):console.log("NO REDIRECT")}).catch(a=>{console.error(a)}).finally(()=>
{ if (this.submitButton.getAttribute('no-animation') != 'true') {let event = new CustomEvent("add-cart-subscription-ended", {});document.dispatchEvent(event);}this.submitButton.classList.remove("loading");this.cart&&this.cart.classList.contains("is-empty")&&this.cart.classList.remove("is-empty");this.error||this.submitButton.removeAttribute("aria-disabled");this.querySelector(".loading-overlay__spinner").classList.add("hidden")})}}handleErrorMessage(b=!1){!this.hideErrors&&(this.errorMessageWrapper=this.errorMessageWrapper||this.querySelector(".product-form__error-message-wrapper"))&&(this.errorMessage=this.errorMessage||this.errorMessageWrapper.querySelector(".product-form__error-message"),
this.errorMessageWrapper.toggleAttribute("hidden",!b),b&&(this.errorMessage.textContent=b))}});