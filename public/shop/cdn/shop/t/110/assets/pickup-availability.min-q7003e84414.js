customElements.get("pickup-availability")||customElements.define("pickup-availability",class extends HTMLElement{constructor(){super();this.hasAttribute("available")&&(this.errorHtml=this.querySelector("template").content.firstElementChild.cloneNode(!0),this.onClickRefreshList=this.onClickRefreshList.bind(this),this.fetchAvailability(this.dataset.variantId))}fetchAvailability(a){let c=this.dataset.rootUrl;c.endsWith("/")||(c+="/");fetch(`${c}variants/${a}/?section_id=pickup-availability`).then(b=>
b.text()).then(b=>{b=(new DOMParser).parseFromString(b,"text/html").querySelector(".shopify-section");this.renderPreview(b)}).catch(b=>{(b=this.querySelector("button"))&&b.removeEventListener("click",this.onClickRefreshList);this.renderError()})}onClickRefreshList(a){this.fetchAvailability(this.dataset.variantId)}renderError(){this.innerHTML="";this.appendChild(this.errorHtml);this.querySelector("button").addEventListener("click",this.onClickRefreshList)}renderPreview(a){const c=document.querySelector("pickup-availability-drawer");
c&&c.remove();a.querySelector("pickup-availability-preview")?(this.innerHTML=a.querySelector("pickup-availability-preview").outerHTML,this.setAttribute("available",""),document.body.appendChild(a.querySelector("pickup-availability-drawer")),(a=this.querySelector("button"))&&a.addEventListener("click",b=>{document.querySelector("pickup-availability-drawer").show(b.target)})):(this.innerHTML="",this.removeAttribute("available"))}});
customElements.get("pickup-availability-drawer")||customElements.define("pickup-availability-drawer",class extends HTMLElement{constructor(){super();this.onBodyClick=this.handleBodyClick.bind(this);this.querySelector("button").addEventListener("click",()=>{this.hide()});this.addEventListener("keyup",a=>{"ESCAPE"===a.code.toUpperCase()&&this.hide()})}handleBodyClick(a){a=a.target;a==this||a.closest("pickup-availability-drawer")||"ShowPickupAvailabilityDrawer"==a.id||this.hide()}hide(){this.removeAttribute("open");
document.body.removeEventListener("click",this.onBodyClick);document.body.classList.remove("overflow-hidden");removeTrapFocus(this.focusElement)}show(a){this.focusElement=a;this.setAttribute("open","");document.body.addEventListener("click",this.onBodyClick);document.body.classList.add("overflow-hidden");trapFocus(this)}});
